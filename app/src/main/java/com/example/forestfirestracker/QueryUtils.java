package com.example.forestfirestracker;

import android.content.Intent;
import android.location.Address;
import android.location.Geocoder;
import android.util.Log;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Locale;

public class QueryUtils {

    private static final String SAMPLE_JSON_RESPONSE="{\"features\":[{\"latitude\":-6.378,\"longitude\":155.411,\"acq_date\":\"2020-09-03\",\"acq_time\":\"0010\",\"satellite\":\"Terra\",\"track\":1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.1,\"brightness\":314,\"confidence\":\"28\",\"frp\":8.6,\"bright_t31\":290.9},{\"latitude\":-32.23,\"longitude\":149.397,\"acq_date\":\"2020-09-03\",\"acq_time\":\"0015\",\"satellite\":\"Terra\",\"track\":1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.1,\"brightness\":307.3,\"confidence\":\"61\",\"frp\":7.1,\"bright_t31\":292.4},{\"latitude\":41.974,\"longitude\":-7.1,\"acq_date\":\"2020-09-04\",\"acq_time\":\"2320\",\"satellite\":\"Terra\",\"track\":1.8,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":3.9,\"brightness\":307.5,\"confidence\":\"72\",\"frp\":66,\"bright_t31\":288.9},{\"latitude\":-22.111,\"longitude\":149.428,\"acq_date\":\"2020-09-05\",\"acq_time\":\"0000\",\"satellite\":\"Terra\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":314.3,\"confidence\":\"57\",\"frp\":14.8,\"bright_t31\":293.4},{\"latitude\":-34.457,\"longitude\":150.876,\"acq_date\":\"2020-09-06\",\"acq_time\":\"2355\",\"satellite\":\"Terra\",\"track\":1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.1,\"brightness\":308.2,\"confidence\":\"41\",\"frp\":5,\"bright_t31\":293.4},{\"latitude\":47.164,\"longitude\":37.529,\"acq_date\":\"2020-09-07\",\"acq_time\":\"0000\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":306,\"confidence\":\"66\",\"frp\":12,\"bright_t31\":286.6},{\"latitude\":11.048,\"longitude\":28.502,\"acq_date\":\"2020-09-08\",\"acq_time\":\"2355\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":302.8,\"confidence\":\"51\",\"frp\":4.6,\"bright_t31\":292.1},{\"latitude\":-12.314,\"longitude\":28.926,\"acq_date\":\"2020-09-09\",\"acq_time\":\"0000\",\"satellite\":\"Aqua\",\"track\":1.6,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":2.9,\"brightness\":303.7,\"confidence\":\"56\",\"frp\":32.3,\"bright_t31\":287},{\"latitude\":-28.722,\"longitude\":19.445,\"acq_date\":\"2020-09-10\",\"acq_time\":\"2355\",\"satellite\":\"Aqua\",\"track\":1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1,\"brightness\":305.2,\"confidence\":\"63\",\"frp\":6.7,\"bright_t31\":292.7},{\"latitude\":-11.097,\"longitude\":132.569,\"acq_date\":\"2020-09-11\",\"acq_time\":\"0100\",\"satellite\":\"Terra\",\"track\":1.6,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":2.7,\"brightness\":315.3,\"confidence\":\"42\",\"frp\":27.5,\"bright_t31\":299.8},{\"latitude\":-32.426,\"longitude\":28.373,\"acq_date\":\"2020-09-12\",\"acq_time\":\"2345\",\"satellite\":\"Aqua\",\"track\":1.3,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.8,\"brightness\":305.2,\"confidence\":\"63\",\"frp\":14.5,\"bright_t31\":292.3},{\"latitude\":-5.473,\"longitude\":148.45,\"acq_date\":\"2020-09-13\",\"acq_time\":\"0045\",\"satellite\":\"Terra\",\"track\":1.2,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.4,\"brightness\":312.5,\"confidence\":\"56\",\"frp\":9.3,\"bright_t31\":296.5},{\"latitude\":-26.032,\"longitude\":30.73,\"acq_date\":\"2020-09-14\",\"acq_time\":\"2330\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":304,\"confidence\":\"58\",\"frp\":11.3,\"bright_t31\":285.2},{\"latitude\":-12.092,\"longitude\":142.021,\"acq_date\":\"2020-09-15\",\"acq_time\":\"0035\",\"satellite\":\"Terra\",\"track\":1.2,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.5,\"brightness\":324.8,\"confidence\":\"78\",\"frp\":25.1,\"bright_t31\":294.1},{\"latitude\":-15.92,\"longitude\":30.092,\"acq_date\":\"2020-09-16\",\"acq_time\":\"2315\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.1,\"brightness\":318.6,\"confidence\":\"97\",\"frp\":18.1,\"bright_t31\":295.3},{\"latitude\":21.334,\"longitude\":-158.006,\"acq_date\":\"2020-09-17\",\"acq_time\":\"0005\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":331.9,\"confidence\":\"76\",\"frp\":22.3,\"bright_t31\":311.1},{\"latitude\":-28.472,\"longitude\":29.214,\"acq_date\":\"2020-09-18\",\"acq_time\":\"2305\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":332.5,\"confidence\":\"100\",\"frp\":46.5,\"bright_t31\":284.9},{\"latitude\":-30.05,\"longitude\":153.133,\"acq_date\":\"2020-09-19\",\"acq_time\":\"0015\",\"satellite\":\"Terra\",\"track\":1.2,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.5,\"brightness\":311.3,\"confidence\":\"70\",\"frp\":15.9,\"bright_t31\":290.9},{\"latitude\":-28.507,\"longitude\":29.295,\"acq_date\":\"2020-09-20\",\"acq_time\":\"2255\",\"satellite\":\"Aqua\",\"track\":1.3,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.9,\"brightness\":302.6,\"confidence\":\"50\",\"frp\":16.4,\"bright_t31\":288.1},{\"latitude\":-24.408,\"longitude\":151.499,\"acq_date\":\"2020-09-21\",\"acq_time\":\"0000\",\"satellite\":\"Terra\",\"track\":1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1,\"brightness\":328.3,\"confidence\":\"81\",\"frp\":22.7,\"bright_t31\":296.7},{\"latitude\":52.56,\"longitude\":39.626,\"acq_date\":\"2020-09-22\",\"acq_time\":\"2355\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":315.9,\"confidence\":\"92\",\"frp\":22.4,\"bright_t31\":283},{\"latitude\":45.618,\"longitude\":20.266,\"acq_date\":\"2020-09-23\",\"acq_time\":\"0000\",\"satellite\":\"Aqua\",\"track\":1.7,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":3.1,\"brightness\":308.1,\"confidence\":\"73\",\"frp\":54.6,\"bright_t31\":281.3},{\"latitude\":35.987,\"longitude\":43.772,\"acq_date\":\"2020-09-24\",\"acq_time\":\"2350\",\"satellite\":\"Aqua\",\"track\":1.8,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":3.8,\"brightness\":304.5,\"confidence\":\"60\",\"frp\":46,\"bright_t31\":292.5},{\"latitude\":-12.271,\"longitude\":25.01,\"acq_date\":\"2020-09-25\",\"acq_time\":\"0000\",\"satellite\":\"Aqua\",\"track\":1.2,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.5,\"brightness\":303.9,\"confidence\":\"58\",\"frp\":13.3,\"bright_t31\":285.7},{\"latitude\":-27.374,\"longitude\":29.791,\"acq_date\":\"2020-09-26\",\"acq_time\":\"2355\",\"satellite\":\"Aqua\",\"track\":1.7,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":3.1,\"brightness\":349.9,\"confidence\":\"100\",\"frp\":342.7,\"bright_t31\":279.9},{\"latitude\":-13.499,\"longitude\":-172.561,\"acq_date\":\"2020-09-27\",\"acq_time\":\"0035\",\"satellite\":\"Aqua\",\"track\":1.8,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":3.9,\"brightness\":311.3,\"confidence\":\"22\",\"frp\":39.5,\"bright_t31\":295.4},{\"latitude\":-16.437,\"longitude\":29.022,\"acq_date\":\"2020-09-28\",\"acq_time\":\"2340\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":321.6,\"confidence\":\"78\",\"frp\":21.7,\"bright_t31\":297.4},{\"latitude\":-16.808,\"longitude\":145.397,\"acq_date\":\"2020-09-29\",\"acq_time\":\"0050\",\"satellite\":\"Terra\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":328,\"confidence\":\"74\",\"frp\":28.5,\"bright_t31\":297.4},{\"latitude\":-18.921,\"longitude\":17.842,\"acq_date\":\"2020-09-30\",\"acq_time\":\"2330\",\"satellite\":\"Aqua\",\"track\":1.9,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":4.3,\"brightness\":308,\"confidence\":\"45\",\"frp\":72.3,\"bright_t31\":290.2},{\"latitude\":20.943,\"longitude\":-156.644,\"acq_date\":\"2020-10-01\",\"acq_time\":\"0015\",\"satellite\":\"Aqua\",\"track\":1.5,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":2.5,\"brightness\":322.6,\"confidence\":\"75\",\"frp\":60.2,\"bright_t31\":291.8},{\"latitude\":-11.992,\"longitude\":35.953,\"acq_date\":\"2020-10-02\",\"acq_time\":\"2315\",\"satellite\":\"Aqua\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":1.2,\"brightness\":323.8,\"confidence\":\"100\",\"frp\":27.6,\"bright_t31\":293.3},{\"latitude\":-25.083,\"longitude\":149.682,\"acq_date\":\"2020-10-03\",\"acq_time\":\"0025\",\"satellite\":\"Terra\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":331.7,\"confidence\":\"80\",\"frp\":28,\"bright_t31\":305.1},{\"latitude\":-25.064,\"longitude\":149.691,\"acq_date\":\"2020-10-03\",\"acq_time\":\"0025\",\"satellite\":\"Terra\",\"track\":1.1,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.3,\"brightness\":336.3,\"confidence\":\"84\",\"frp\":35.9,\"bright_t31\":305.4},{\"latitude\":71.268,\"longitude\":72.071,\"acq_date\":\"2020-10-03\",\"acq_time\":\"0025\",\"satellite\":\"Aqua\",\"track\":1.6,\"instrument\":\"MODIS\",\"daynight\":\"N\",\"version\":\"6.0NRT\",\"scan\":2.7,\"brightness\":328.7,\"confidence\":\"100\",\"frp\":138.6,\"bright_t31\":271.4},{\"latitude\":-13.881,\"longitude\":143.564,\"acq_date\":\"2020-10-03\",\"acq_time\":\"0025\",\"satellite\":\"Terra\",\"track\":1.3,\"instrument\":\"MODIS\",\"daynight\":\"D\",\"version\":\"6.0NRT\",\"scan\":1.8,\"brightness\":317,\"confidence\":\"25\",\"frp\":14.5,\"bright_t31\":288.2}]}";
    private QueryUtils() {
    }
    public static ArrayList<Fire> extractFires() {

        // Create an empty ArrayList that we can start adding earthquakes to
        ArrayList<Fire> fires = new ArrayList<>();
        // Try to parse the SAMPLE_JSON_RESPONSE. If there's a problem with the way the JSON
        // is formatted, a JSONException exception object will be thrown.
        // Catch the exception so the app doesn't crash, and print the error message to the logs.
        try {

            JSONObject reader = new JSONObject(SAMPLE_JSON_RESPONSE);
            JSONArray features  = reader.getJSONArray("features");

            for(int i = 0; i<features.length();i++) {
                JSONObject f  = features.getJSONObject(i);

                double lat = f.getDouble("latitude");
                double lng = f.getDouble("longitude");

                /*-----------------------*/

                String date = f.getString("acq_date");

                fires.add(new Fire(lat,lng,date));
            }
            // TODO: Parse the response given by the SAMPLE_JSON_RESPONSE string and
            // build up a list of Earthquake objects with the corresponding data.

        } catch (JSONException e) {
            // If an error is thrown when executing any of the above statements in the "try" block,
            // catch the exception here, so the app doesn't crash. Print a log message
            // with the message from the exception.
            Log.e("QueryUtils", "Problem parsing the earthquake JSON results", e);
        }
        // Return the list of earthquakes
        return fires;
    }
}
